<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta
			http-equiv="Content-Security-Policy"
			content="script-src 'self' https://nash268.github.io 'nonce-ABC123'; worker-src 'self';"
		/>
		<title>Pomodoro</title>
		<link
			rel="icon"
			type="image/png"
			href="/pomodoro/assets/icons/icon-512x512.png"
			sizes="512x512"
		/>
		<link
			rel="icon"
			type="image/png"
			href="/pomodoro/assets/icons/icon-192x192.png"
			sizes="192x192"
		/>
		<link
			rel="icon"
			type="image/png"
			href="/pomodoro/assets/icons/icon-256x256.png"
			sizes="256x256"
		/>
		<link rel="manifest" href="manifest.json" crossorigin="use-credentials" />
		<link rel="stylesheet" href="assets/css/styles.css" type="text/css" />
		<script src="assets/js/app.js"></script>
	</head>
	<body>
		<h1>Pomodoro App</h1>
		<div class="timer-container">
			<button id="pomo-btn">start <span>(25 minutues)</span></button>
			<button id="break-btn" style="margin-left: 10%;">
				break <span>(5 minutues)</span>
			</button>
		</div>
		<div class="timer-container">
			<div class="timer" id="timer">00:00</div>
		</div>
		<div class="heatmap-container">
			<div class="heatmap" id="heatmap"></div>
		</div>
		<div id="xp-bar-container">
			<div id="xp-bar"></div>
		</div>
		<div id="level-info">
			<span id="level">Level 1</span>
			<span id="title">Noob</span>
		</div>
		<div id="xp-info">
			<span id="current-xp">0</span> / <span id="next-level-xp">100</span> XP
		</div>
	</body>
	<script nonce="ABC123">
		if ("serviceWorker" in navigator) {
			navigator.serviceWorker
				.register("/pomodoro/service-worker.js")
				.then((registration) => {
					console.log("[App] Service Worker Registered:", registration);
				})
				.catch((error) => {
					console.error("[App] Service Worker Registration Failed:", error);
				});

			navigator.serviceWorker.addEventListener("message", (event) => {
				if (event.data.type === "UPDATE_AVAILABLE") {
					const userConfirmed = confirm(
						"A new update is available. Do you want to refresh?"
					);
					if (userConfirmed) {
						window.location.reload();
					}
				}
			});
		}
	</script>
</html>
